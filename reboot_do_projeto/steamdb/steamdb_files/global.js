(function(){"use strict";let D=!1,O=!1,C=[],U=!1,B=[],v=[],k;const V=e=>{const t=typeof $=="function"&&typeof $.fn=="object"&&typeof $.fn.dataTable=="function";let o=t?[]:document.querySelectorAll(".app"),s=t?[]:document.querySelectorAll(".package");t&&($($.fn.dataTable.tables()).each(function(){const n=$(this).DataTable().table();o=n.rows(".app").nodes().reduce(function(a,d){return a.push(d),a},o),s=n.rows(".package").nodes().reduce(function(a,d){return a.push(d),a},s)}),o.length===0&&document.body.classList.contains("page-calculator")&&(o=document.querySelectorAll(".app")));const p=[],f=[];for(const n of o){const a=+n.dataset.appid,d=p[a];d?d.push(n):p[a]=[n]}o=null;for(const n of s){const a=+n.dataset.subid,d=f[a];d?d.push(n):f[a]=[n]}if(s=null,e.rgFollowedApps){window.SteamDB.FollowedApps=new Set(e.rgFollowedApps);for(const n of e.rgFollowedApps){const a=p[n];if(a)for(const d of a)d.classList.add("followed")}}if(e.rgWishlist){window.SteamDB.WishedApps=new Set(e.rgWishlist);for(const n of e.rgWishlist){const a=p[n];if(a)for(const d of a)d.classList.add("wished")}}if(e.rgAppsInCart)for(const n of e.rgAppsInCart){const a=p[n];if(a)for(const d of a)d.classList.add("cart")}if(e.rgOwnedApps){window.SteamDB.OwnedApps=new Set(e.rgOwnedApps);for(const n of e.rgOwnedApps){const a=p[n];if(a)for(const d of a)d.classList.add("owned")}}if(e.rgIgnoredApps)for(let n of Object.keys(e.rgIgnoredApps)){n=+n,window.SteamDB.IgnoredApps.add(n);const a=p[n];if(a)for(const d of a)d.classList.add("ignored")}if(e.rgOwnedPackages&&(window.SteamDB.OwnedPackages=new Set(e.rgOwnedPackages)),window.SteamDB.OwnedPackages.add(0),f.length>0){if(e.rgPackagesInCart)for(const n of e.rgPackagesInCart){const a=f[n];if(a)for(const d of a)d.classList.add("cart")}if(e.rgOwnedPackages)for(const n of e.rgOwnedPackages){const a=f[n];if(a)for(const d of a)d.classList.add("owned")}}};window.SteamDB={FollowedApps:new Set,IgnoredApps:new Set,OwnedApps:new Set,WishedApps:new Set,OwnedPackages:new Set,OnExtensionUserdataLoaded:e=>{if(U){e();return}B.push(e)},EnhanceLazyLoadedApps:e=>{const t=e.querySelectorAll(".app");for(const o of t){const s=+o.dataset.appid;window.SteamDB.FollowedApps.has(s)&&o.classList.add("followed"),window.SteamDB.WishedApps.has(s)&&o.classList.add("wished"),window.SteamDB.OwnedApps.has(s)&&o.classList.add("owned"),window.SteamDB.IgnoredApps.has(s)&&o.classList.add("ignored")}window.SteamDB.BindHover(e)},BindHover:()=>{},HideHoverIfAny:()=>{},Alert:(e,t=null)=>{const o=document.createElement("toast-notification");return t!==null&&(o.title=t),o.body=e,document.querySelector("#js-notifications").append(o),o},Storage:{Get(e){try{return window.localStorage.getItem(e)}catch{return null}},Set(e,t){try{window.localStorage.setItem(e,t)}catch{}},Remove(e){try{window.localStorage.removeItem(e)}catch{}}},LazyLoad(e,t){if(!("IntersectionObserver"in window)){t();return}k||(k=new window.IntersectionObserver(o=>{o.forEach(s=>{s.isIntersecting&&(k.unobserve(s.target),s.target.dispatchEvent(new Event("lazyload")))})})),k.observe(e),e.addEventListener("lazyload",t,{once:!0})},ImageError(e){e.complete&&e.naturalWidth===0?e.src="/static/img/applogo.svg":e.addEventListener("error",function(){this.src="/static/img/applogo.svg"},{once:!0})},RequirePageScreenshotViewer(e,t=!1){if(t){for(let o=0;o<v.length;o++)v[o](e);v=[],window.SteamDB.RequirePageScreenshotViewer=o=>o(e)}else v.push(e)},RequireHighstock(e){if(window.Highcharts){P(),e();return}if(C.push(e),D)return;D=!0;const t=document.createElement("script");t.nonce=document.querySelector("script[nonce]").nonce,t.src="/static/js/vendor/highstock.js?v=a091f0035dc9e6b3",t.integrity="sha512-oJHwA13J5rOL+aiMDwungAJUhJSxWbZuQNHrDgRNE7033UkScc5yweYk3x6Qx0odsWZVhp2kaNJgCEnnJyzE3A==",t.async=!0,t.addEventListener("load",function(){P();for(const o of C)o();C=[],D=!1}),document.head.appendChild(t)}};const P=()=>{O||(O=!0,window.Highcharts.wrap(window.Highcharts.seriesTypes.flags.prototype,"translate",function(e){if(e.apply(this,...arguments),!this.options.onSeries)return;const t=this.chart.get(this.options.onSeries);!t||!t.currentDataGrouping||this.points.forEach(o=>{const s=t.points.find(f=>f.x>o.x);if(!s)return;const p=t.points[s.index>0?s.index-1:0];o.plotX=p.plotX,o.plotY=p.plotY})}),window.Highcharts.setOptions({accessibility:{enabled:!1},chart:{animation:!1,zooming:{type:"x",mouseWheel:{enabled:!1}},backgroundColor:"transparent",spacing:[5,0,15,0],style:{fontSize:"16px",fontFamily:"inherit"}},title:{style:{color:"var(--body-color)"}},yAxis:{gridLineColor:"rgba(180, 180, 180, 0.2)",labels:{style:{color:"var(--muted-color)"}}},xAxis:{lineColor:"var(--border-color)",tickColor:"var(--border-color)",crosshair:{width:30,color:"rgba(180, 180, 180, 0.2)"},labels:{style:{color:"var(--body-color)"}}},legend:{itemHoverStyle:{color:"var(--link-color)"},itemHiddenStyle:{color:"var(--border-color)"},itemStyle:{color:"var(--body-color)",fontSize:"16px",fontWeight:"400"}},plotOptions:{series:{animation:!1,dataGrouping:{enabled:!1},states:{hover:{lineWidthPlus:0}}}},credits:{text:"data by SteamDB.info (powered by highcharts.com)",position:{x:0,y:-3},style:{fontSize:"12px",color:"var(--muted-color)"}},exporting:{buttons:{contextButton:{symbol:"url(/static/img/download.svg)",symbolSize:24,symbolX:26,symbolY:24,menuItems:["downloadCSV","downloadXLS"],theme:{fill:"none",states:{hover:{fill:"var(--border-color-2)"},select:{fill:"var(--border-color)"}}}}}},navigation:{menuStyle:{borderRadius:"6px",borderColor:"var(--border-color)",background:"var(--tooltip-bg)",boxShadow:"-8px -8px 24px rgba(149, 157, 165, 0.2)"},menuItemStyle:{color:"var(--body-bg-color)",transition:"none",fontSize:"14px"}},rangeSelector:{inputEnabled:!1,labelStyle:{color:"var(--body-color)"},buttonTheme:{width:"auto",height:24,paddingLeft:10,paddingRight:10,fill:"none",r:6,stroke:"var(--border-color)","stroke-width":"1px",style:{color:"var(--link-color)",fontSize:"16px",fontWeight:"bold"},states:{hover:{fill:"var(--border-color)",style:{color:"var(--link-color-hover)"}},select:{fill:"var(--border-color)",style:{color:"var(--body-color)"}},disabled:{"stroke-width":0,style:{color:"var(--border-color)"}}}}},navigator:{handles:{backgroundColor:"var(--border-color-2)",borderColor:"var(--link-color)"},xAxis:{gridLineColor:"var(--border-color)",labels:{style:{color:"var(--muted-color)",opacity:1}}},series:{lineWidth:2},outlineColor:"var(--border-color)"},tooltip:{shared:!0,split:!1,shadow:!1,borderWidth:0,borderRadius:6,headerFormat:"{point.key} UTC<br/>",backgroundColor:"var(--tooltip-bg)",style:{fontSize:"14px",color:"var(--body-bg-color)"}}}))},I=(e,t,o)=>{document.querySelectorAll(e).forEach(s=>{o?s.classList.add(t):s.classList.remove(t)})},w=(e,t,o)=>I(`.app[data-appid="${e}"]`,t,o),A=(e,t,o)=>I(`.package[data-subid="${e}"]`,t,o),W=(e,t,o)=>I(`.bundle[data-bundleid="${e}"]`,t,o),j=e=>{if(!(!e.response||!e.response.success)){if(e.request.appid>0){const t=e.request.appid;switch(e.request.contentScriptQuery){case"StoreWishlistAdd":window.SteamDB.WishedApps.add(t),w(t,"wished",!0);break;case"StoreWishlistRemove":window.SteamDB.WishedApps.delete(t),w(t,"wished",!1);break;case"StoreFollow":window.SteamDB.FollowedApps.add(t),w(t,"followed",!0);break;case"StoreUnfollow":window.SteamDB.FollowedApps.delete(t),w(t,"followed",!1);break;case"StoreIgnore":window.SteamDB.IgnoredApps.add(t),w(t,"ignored",!0);break;case"StoreUnignore":window.SteamDB.IgnoredApps.delete(t),w(t,"ignored",!1);break;case"Watch":w(t,"watched",!0);break;case"Unwatch":w(t,"watched",!1);break}}else if(e.request.subid>0){const t=e.request.subid;switch(e.request.contentScriptQuery){case"StoreAddToCart":A(t,"cart",!0);break;case"StoreAddFreeLicense":A(t,"owned",!0);break;case"Watch":A(t,"watched",!0);break;case"Unwatch":A(t,"watched",!1);break}}else if(e.request.bundleid>0){const t=e.request.bundleid;switch(e.request.contentScriptQuery){case"Watch":W(t,"watched",!0);break;case"Unwatch":W(t,"watched",!1);break}}}};if("BroadcastChannel"in window){let e=null;try{e=new BroadcastChannel("steamdb-extension"),e.addEventListener("message",t=>{t&&t.data&&t.data.type==="steamdb:extension-response"&&j(t.data)})}catch{}window.addEventListener("message",t=>{if(!(!t||!t.data)&&t.origin===window.location.origin)if(t.data.type==="steamdb:extension-loaded"){U=!0,V(t.data.data);for(const o of B)o();B=[]}else if(t.data.type==="steamdb:extension-init")document.querySelectorAll(".js-extension-tip").forEach(o=>{o.hidden=!0}),"OnExtensionInit"in window.SteamDB&&window.SteamDB.OnExtensionInit(t.data.data);else if(t.data.type==="steamdb:extension-error"){try{if(window.sessionStorage.getItem("extension_error_hidden")&&location.pathname!=="/freepackages/")return}catch{}const o=window.SteamDB.Alert(t.data.error,"Extension error");if(typeof InstallTrigger<"u"||navigator.userAgent.includes(" Firefox/")){const p=document.createElement("div");p.textContent="If you use Firefox containers, extension is not compatible with it.",o.append(p)}const s=document.createElement("a");s.className="btn btn-sm btn-primary",s.href="https://store.steampowered.com/login/",s.textContent="Sign in on the Steam Store",o.append(s),o.addEventListener("toast-close",()=>{try{window.sessionStorage.setItem("extension_error_hidden","1")}catch{}})}else t.data.type==="steamdb:extension-response"&&(e!==null&&e.postMessage(t.data),j(t.data),(!t.data.response||!t.data.response.success)&&!location.pathname.startsWith("/freepackages/")&&(window.SteamDB.Alert(`Something went wrong.
`+(t.data.response&&t.data.response.error||"Unknown error. Are you logged in on the Steam store?"),"Extension error"),console.error(t.data.response)))})}const Q=e=>{const t=[];if(e.forEach((o,s)=>{const p=s.toLowerCase();(p==="__cf_chl_captcha_tk__"||p==="__cf_chl_jschl_tk__"||p==="ref"||p==="fbclid"||p.startsWith("utm_"))&&t.push(s)}),t.length>0){for(const o of t)e.delete(o);window.history.replaceState(null,null,Array.from(e).length?`${location.pathname}?${e}`:location.pathname)}},b=document.querySelector(".header"),m=document.querySelector(".header-menu-container"),L=document.querySelector("#js-header-hamburger"),q=document.querySelector(".account-menu"),F=document.querySelector(".header-user-avatar");F&&F.addEventListener("click",e=>{e.preventDefault(),q.hidden=!q.hidden}),L.addEventListener("click",function(){m.hidden=!m.hidden,m.hidden||(m.querySelector(".header-menu").focus(),b.classList.remove("header-search-focus"),window.SteamDB.HideHoverIfAny())}),m.addEventListener("click",function(e){e.target.className===m.className&&(m.hidden=!0)});const T=document.getElementById("js-header-form"),g=T.querySelector(".field");document.addEventListener("keydown",e=>{if(e.key==="Escape"){if(document.documentElement.classList.contains("js-screenshots-shown"))return;m.hidden?b.classList.remove("header-search-focus"):(m.hidden=!0,L.focus())}e.ctrlKey||e.metaKey||["INPUT","TEXTAREA","SELECT","BUTTON"].includes(e.target.tagName)&&e.target!==L||(e.code==="Slash"||e.code==="KeyS"||e.key==="/"||e.key==="s"?(e.preventDefault(),g.focus()):(e.code==="KeyM"||e.key==="m")&&L.click())});function X(){this.src="/static/p.gif"}if(T){T.addEventListener("submit",function(l){const i=g.value.replace(/^\s+|\s+$/g,"");let r=i.match(/^([0-9]{1,7})$/);if(r!==null){window.location=`/app/${r[0]}/`,l.preventDefault();return}if(r=i.match(/(7656119[0-9]{10})/),r!==null){window.location=`/calculator/${r[1]}/`,l.preventDefault();return}if(r=i.match(/(?:id|profiles)\/([\d\w-]+)/),r!==null){window.location=`/calculator/?player=${r[1]}`,l.preventDefault();return}r=i.match(/(app|sub|bundle|depot|dlc)\/([0-9]{1,8})/),r!==null&&(r[1]==="dlc"&&(r[1]="app"),window.location=`/${r[1]}/${r[2]}/`,l.preventDefault())},!1);const e=document.getElementById("js-search-suggestions"),t=document.getElementById("js-search-tips"),o=new Map;let s=0,p=0,f="",n;const a=t.dataset.a,d={Accept:"application/json","x-algolia-application-id":a,"x-algolia-api-key":t.dataset.k},R=()=>{s=0;const l={hitsPerPage:10,attributesToSnippet:null,attributesToHighlight:"name",attributesToRetrieve:"objectID,lastUpdated,small_capsule",query:f};n&&n.abort(),n=new AbortController,fetch(`https://${a}-dsn.algolia.net/1/indexes/steamdb/query?x-algolia-agent=SteamDB%20Autocompletion`,{method:"POST",body:JSON.stringify(l),signal:n.signal,headers:d}).then(i=>i.json()).then(i=>{o.set(l.query,i),n=null,H(i)}).catch(console.error)},K=()=>{s=0;const l={hitsPerPage:20,attributesToSnippet:null,attributesToHighlight:"name",attributesToRetrieve:"type,id,lastUpdated,small_capsule",query:f};n&&n.abort(),n=new AbortController,fetch(`https://${a}-dsn.algolia.net/1/indexes/all_names/query?x-algolia-agent=SteamDB%20Autocompletion`,{method:"POST",body:JSON.stringify(l),signal:n.signal,headers:d}).then(i=>i.json()).then(i=>{n=null,H(i,!1)}).catch(console.error)},H=(l,i=!0)=>{const r=document.body.dataset.storeAssets;let x=-1;const N=new Set;if(i){const c=e.querySelector(".focus");if(c&&(x=+c.dataset.appid),t.hidden=!0,e.replaceChildren(),window.SteamDB.HideHoverIfAny(),!l.nbHits){const u=document.createElement("span");l.message?u.innerText=`Algolia error: ${l.message}`:(u.innerText="No results found.",z()),e.appendChild(u);return}}else{if(!l.nbHits)return;const c=o.get(f);if(c)for(const u of c.hits)N.add(`a${u.objectID}`)}let M="",J=0;{const c=location.pathname.match(/\/app\/[0-9]+\/(?<page>\w+)/);c&&(M=`${c.groups.page}/`)}for(const c of l.hits){if(N.has(c.objectID))continue;const u=document.createElement("a");i?(c.type="app",c.id=+c.objectID):(c.lastUpdated=0,u.classList.add("app-small"));let S="/static/img/applogo.svg",y=c._highlightResult.name.value;switch(i||(y=`${y} <span class="muted">(${c.type}/${c.id})</span>`),c.type){case"app":{const h=c.id;u.classList.add("app"),u.dataset.appid=h,u.href=`/app/${h}/${M}`,u.innerHTML=y,window.SteamDB.OwnedApps.has(h)?u.classList.add("owned"):window.SteamDB.WishedApps.has(h)?u.classList.add("wished"):window.SteamDB.FollowedApps.has(h)&&u.classList.add("followed"),x===h&&(x=-1,u.classList.add("focus")),c.small_capsule?S=`${r}apps/${h}/${c.small_capsule}/capsule_231x87.jpg`:S=`${r}apps/${h}/capsule_231x87.jpg?t=${c.lastUpdated}`;break}case"sub":{const h=c.id;u.classList.add("app"),u.href=`/sub/${h}/`,u.innerHTML=y,window.SteamDB.OwnedPackages.has(h)&&u.classList.add("owned"),S=`${r}subs/${h}/capsule_231x87.jpg`;break}case"bundle":{const h=c.id;u.classList.add("app"),u.href=`/bundle/${h}/`,u.innerHTML=y,c.small_capsule&&(S=`${r}bundles/${h}/${c.small_capsule}/capsule_231x87.jpg`);break}}const E=document.createElement("img");if(E.addEventListener("error",X,{once:!0}),E.alt="",E.src=S,u.prepend(E),e.appendChild(u),++J>10)break}if(i){if(x>-1){const c=e.firstElementChild;c&&c.classList.add("focus")}window.SteamDB.BindHover(e),window.innerHeight>200+J*55&&z()}},z=()=>{clearTimeout(s),p=1/0,s=setTimeout(K,1e3)},_=()=>{b.classList.add("header-search-focus"),m.hidden=!0,window.SteamDB.HideHoverIfAny()};g.addEventListener("keydown",function(l){if(l.key==="ArrowUp"||l.key==="ArrowDown"){l.preventDefault();const i=e.querySelector(".focus");let r;l.key==="ArrowUp"?(i&&(r=i.previousSibling),r||(r=e.lastElementChild)):(i&&(r=i.nextSibling),r||(r=e.firstElementChild)),r&&(i&&i.classList.remove("focus"),r.classList.add("focus"))}else if(l.key==="Enter"){if(l.ctrlKey){const r=new URLSearchParams;r.append("query",f),window.location.href=`/instantsearch/?${r.toString()}`,l.preventDefault();return}const i=e.querySelector(".focus");i&&(i.click(),l.preventDefault())}else l.key==="Escape"&&g.blur()}),g.addEventListener("input",function(){_();const l=this.value;if(!l||l.length>200){e.replaceChildren(),f="",t.hidden=!1,window.SteamDB.HideHoverIfAny();return}if(f===l)return;f=l;const i=o.get(f);if(i){clearTimeout(s),s=0,H(i);return}const r=Date.now();if(s){r-p<200&&(clearTimeout(s),p=r,s=setTimeout(R,200));return}p=r,s=setTimeout(R,350)}),document.querySelector(".header-search-close").addEventListener("click",()=>{b.classList.remove("header-search-focus")}),document.querySelector(".header-search-side-close").addEventListener("click",()=>{b.classList.remove("header-search-focus")}),document.querySelector(".header-search-mobile").addEventListener("click",()=>{_(),g.focus()}),g.addEventListener("focus",_)}if(window.location.hostname==="steamdb.info"){const e=new URLSearchParams(location.search);Q(e)}"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).catch(e=>{console.error(e)})})();
